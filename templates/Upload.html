{% extends "signedInBase.html" %}

{% block title %}Upload â€“ ShareSpace{% endblock %}

{% block nav_upload %}{{ ACTIVE }}{% endblock %}
{% block mob_upload %}text-primary{% endblock %}

{% block content %}

    <!-- Main Content -->
        <!-- Top Bar -->
        <div class="mb-8">
            <div class="flex items-center gap-3 mb-4">
                <a href="/browse" class="text-body-color dark:text-dark-6 hover:text-primary transition">
                    <i class="fas fa-arrow-left"></i>
                </a>
                <h1 class="text-3xl font-bold">Add New Item</h1>
            </div>
            <p class="text-body-color dark:text-dark-6">List an item you want to swap with fellow students</p>
        </div>

        <!-- Form Container -->
        <div class="w-full">
            <!-- Error/Success Messages -->
            {% if error %}
            <div class="bg-red bg-opacity-10 border border-red text-red px-6 py-4 rounded-lg mb-6">
                <i class="fas fa-exclamation-circle mr-2"></i>{{ error }}
            </div>
            {% endif %}

            {% if success %}
            <div class="bg-green bg-opacity-10 border border-green text-green px-6 py-4 rounded-lg mb-6">
                <i class="fas fa-check-circle mr-2"></i>{{ success }}
            </div>
            {% endif %}

            <!-- Form -->
            <form action="/upload" method="POST" enctype="multipart/form-data"
                class="w-full bg-white dark:bg-dark-2 rounded-xl
                        p-4 sm:p-6 md:p-8 lg:p-10
                        shadow-lg">

                <!-- Item Name -->
                <div class="mb-6">
                    <label for="name" class="block text-sm font-semibold text-body-color dark:text-dark-6 mb-2">
                        Item Name <span class="text-red">*</span>
                    </label>
                    <input
                        type="text"
                        id="name"
                        name="name"
                        required
                        placeholder="e.g., Data Structures Textbook"
                        class="w-full px-5 py-3 bg-gray-1 dark:bg-dark border border-stroke dark:border-dark-3 rounded-lg text-body-color dark:text-dark placeholder:text-dark dark:placeholder:text-dark-6 focus:border-primary focus:outline-none transition">
                </div>

                <!-- Category -->
                <div class="mb-6">
                    <label for="category" class="block text-sm font-semibold text-body-color dark:text-dark-6 mb-2">
                        Category <span class="text-red">*</span>
                    </label>
                    <select
                        id="category"
                        name="category"
                        required
                        class="w-full px-5 py-3 bg-gray-1 dark:bg-dark border border-stroke dark:border-dark-3 rounded-lg text-body-color dark:text-dark focus:border-primary focus:outline-none transition">
                        <option value="">Select a category</option>
                        <option value="books">Books & Textbooks</option>
                        <option value="electronics">Electronics</option>
                        <option value="stationery">Stationery</option>
                        <option value="furniture">Furniture</option>
                        <option value="sports">Sports Equipment</option>
                        <option value="clothing">Clothing</option>
                        <option value="other">Other</option>
                    </select>
                </div>

                <!-- Description -->
                <div class="mb-6">
                    <label for="description" class="block text-sm font-semibold text-body-color dark:text-dark-6 mb-2">
                        Description <span class="text-red">*</span>
                    </label>
                    <textarea
                        id="description"
                        name="description"
                        rows="4"
                        required
                        placeholder="Describe your item, its condition, and what you're looking for in exchange..."
                        class="w-full px-5 py-3 bg-gray-1 dark:bg-dark border border-stroke dark:border-dark-3 rounded-lg text-body-color dark:text-dark placeholder:text-body-color dark:placeholder:text-dark-6 focus:border-primary focus:outline-none transition resize-none"></textarea>
                    <p class="text-xs text-body-color dark:text-dark-6 mt-2">
                        <i class="fas fa-info-circle mr-1"></i>Be detailed to help others understand what you're offering
                    </p>
                </div>

                <!-- Condition -->
                <div class="mb-6">
                    <label for="condition" class="block text-sm font-semibold text-body-color dark:text-dark-6 mb-2">
                        Condition <span class="text-red">*</span>
                    </label>
                    <select
                        id="condition"
                        name="condition"
                        required
                        class="w-full px-5 py-3 bg-gray-1 dark:bg-dark border border-stroke dark:border-dark-3 rounded-lg text-body-color dark:text-dark focus:border-primary focus:outline-none transition">
                        <option value="">Select condition</option>
                        <option value="new">New - Never used</option>
                        <option value="like-new">Like New - Used once or twice</option>
                        <option value="good">Good - Shows some wear</option>
                        <option value="fair">Fair - Visible wear but functional</option>
                        <option value="poor">Poor - Heavy wear</option>
                    </select>
                </div>

                <!-- Looking For (What they want in exchange) -->
                <div class="mb-6">
                    <label for="looking_for" class="block text-sm font-semibold text-body-color dark:text-dark-6 mb-2">
                        What are you looking for? <span class="text-body-color dark:text-dark-6 text-xs font-normal">(Optional)</span>
                    </label>
                    <input
                        type="text"
                        id="looking_for"
                        name="looking_for"
                        placeholder="e.g., Biology textbook, Calculator, Sports equipment"
                        class="w-full px-5 py-3 bg-gray-1 dark:bg-dark border border-stroke dark:border-dark-3 rounded-lg text-body-color dark:text-dark placeholder:text-body-color dark:placeholder:text-dark-6 focus:border-primary focus:outline-none transition">
                    <p class="text-xs text-body-color dark:text-dark-6 mt-2">
                        <i class="fas fa-lightbulb mr-1"></i>This helps us match you with relevant swap partners
                    </p>
                </div>

                <!-- Image Upload -->
                <div class="mb-6">
                    <label for="image" class="block text-sm font-semibold text-body-color dark:text-dark-6 mb-2">
                        Item Photo <span class="text-body-color dark:text-dark-6 text-xs font-normal">(Optional)</span>
                    </label>
                    <div class="border-2 border-dashed border-stroke dark:border-dark-3 rounded-lg p-8 text-center hover:border-primary transition">
                        <input
                            type="file"
                            id="image"
                            name="image"
                            accept="image/*"
                            class="hidden"
                            onchange="previewImage(this)">
                        <label for="image" class="cursor-pointer">
                            <div id="image-preview" class="hidden mb-4">
                                <img id="preview-img" src="" alt="Preview" class="max-h-48 mx-auto rounded-lg">
                            </div>
                            <div id="upload-placeholder">
                                <i class="fas fa-cloud-upload-alt text-5xl text-body-color dark:text-dark-6 mb-4"></i>
                                <p class="text-body-color dark:text-dark-6 mb-2">
                                    <span class="text-primary font-semibold">Click to upload</span> or drag and drop
                                </p>
                                <p class="text-xs text-body-color dark:text-dark-6">
                                    PNG, JPG, or JPEG (MAX. 5MB)
                                </p>
                            </div>
                        </label>
                    </div>
                </div>

                <!-- Location/Hostel -->
                <div class="mb-6">
                    <label for="Hostel" class="block text-sm font-semibold text-body-color dark:text-dark-6 mb-2">
                        Your Location <span class="text-red">*</span>
                    </label>
                    <input
                        type="text"
                        id="hostel"
                        name="hostel"
                        required
                        placeholder="e.g., West Hall, Room 301"
                        value="{{ session.hostel if session.hostel else '' }}"
                        class="w-full px-5 py-3 bg-gray-1 dark:bg-dark border border-stroke dark:border-dark-3 rounded-lg text-body-color dark:text-dark placeholder:text-body-color dark:placeholder:text-dark-6 focus:border-primary focus:outline-none transition">
                    <p class="text-xs text-body-color dark:text-dark-6 mt-2">
                        <i class="fas fa-map-marker-alt mr-1"></i>This helps others find you for the swap
                    </p>
                </div>

                <!-- Contact Preference -->
                <div class="mb-8">
                    <label class="block text-sm font-semibold text-body-color dark:text-dark-6 mb-3">
                        Preferred Contact Method <span class="text-red">*</span>
                    </label>
                    <div class="space-y-2">
                        <label class="flex items-center gap-3 p-3 bg-gray-1 dark:bg-dark rounded-lg cursor-pointer hover:bg-gray-2 dark:hover:bg-dark-3 transition">
                            <input type="radio" name="contact_method" value="email" checked class="text-primary focus:ring-primary">
                            <div>
                                <span class="text-body-color dark:text-dark-6 font-medium">Email</span>
                                <p class="text-xs text-body-color dark:text-dark-6">{{ session.email if session.email else 'your@email.com' }}</p>
                            </div>
                        </label>
                        <label class="flex items-center gap-3 p-3 bg-gray-1 dark:bg-dark rounded-lg cursor-pointer hover:bg-gray-2 dark:hover:bg-dark-3 transition">
                            <input type="radio" name="contact_method" value="phone" class="text-primary focus:ring-primary">
                            <div>
                                <span class="text-body-color dark:text-dark-6 font-medium">Phone</span>
                                <p class="text-xs text-body-color dark:text-dark-6">{{ session.phone if session.phone else 'Your phone number' }}</p>
                            </div>
                        </label>
                        <label class="flex items-center gap-3 p-3 bg-gray-1 dark:bg-dark rounded-lg cursor-pointer hover:bg-gray-2 dark:hover:bg-dark-3 transition">
                            <input type="radio" name="contact_method" value="both" class="text-primary focus:ring-primary">
                            <div>
                                <span class="text-body-color dark:text-dark-6 font-medium">Both</span>
                                <p class="text-xs text-body-color dark:text-dark-6">Contact me via email or phone</p>
                            </div>
                        </label>
                    </div>
                </div>

                <!-- Form Actions -->
                <div class="flex flex-col sm:flex-row gap-4 mt-8">
                    <button
                        type="submit"
                        class="flex-1 px-6 py-4 bg-primary text-white rounded-lg font-semibold hover:bg-blue-dark transition shadow-lg">
                        <i class="fas fa-plus mr-2"></i>List Item
                    </button>
                    <a
                        href="/browse"
                        class="px-6 py-4 bg-gray-1 dark:bg-dark text-body-color dark:text-dark-6 rounded-lg font-semibold hover:bg-gray-2 dark:hover:bg-dark-3 transition text-center">
                        Cancel
                    </a>
                </div>
            </form>
        </div>
    <!-- </main> -->

    <script>
        function previewImage(input) {
            const preview = document.getElementById('image-preview');
            const previewImg = document.getElementById('preview-img');
            const placeholder = document.getElementById('upload-placeholder');

            if (input.files && input.files[0]) {
                const reader = new FileReader();

                reader.onload = function(e) {
                    previewImg.src = e.target.result;
                    preview.classList.remove('hidden');
                    placeholder.classList.add('hidden');
                }

                reader.readAsDataURL(input.files[0]);
            }
        }
    </script>

{% endblock %}
